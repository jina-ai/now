jtype: Flow
with:
  name: nowapi
  port_expose: 8080
  cors: True
executors:
  - name: encoder_clip
    uses: {ENCODER_NAME}
    resources:
      memory: 8G
    uses_with:
      pretrained_model_name_or_path: {CLIP_MODEL_NAME}
  - name: linear_head
    uses: {LINEAR_HEAD_NAME}
    uses_with:
      final_layer_output_dim: {OUTPUT_DIM}
      embedding_size: {EMBED_DIM}
  - name: indexer
    uses: {INDEXER_NAME}
    uses_with:
      dim: {EMBED_DIM}
      metric: cosine
    uses_metas:
      workspace: pq_workspace