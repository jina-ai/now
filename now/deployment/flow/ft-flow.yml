jtype: Flow
with:
  name: nowapi
  port_expose: 8080
  cors: True
executors:
  - name: encoder_clip
    uses: jinahub+docker://CLIPEncoder/v0.2.1
    resources:
      memory: 8G
    uses_with:
      pretrained_model_name_or_path: openai/clip-vit-base-patch32
    env:
      JINA_LOG_LEVEL: DEBUG
  - name: linear_head
    uses: jinahub+docker://FineTunedLinearHeadEncoder
    uses_with:
      final_layer_output_dim: final_layer_output_dim
      embedding_size: embedding_size
    env:
      JINA_LOG_LEVEL: DEBUG
  - name: indexer
    uses: jinahub+docker://MostSimpleIndexer:346e8475359e13d621717ceff7f48c2a
    uses_with:
      dim: embedding_size
      metric: cosine
    uses_metas:
      workspace: pq_workspace
    env:
      JINA_LOG_LEVEL: DEBUG